---
title: Create a simple custom control
description: "Learn how to create a custom control that displays a string with a horizontal alignment."
ms.topic: how-to
ms.date: 01/14/2025
dev_langs:
  - "csharp"
  - "vb"
helpviewer_keywords:
  - "inheritance [Windows Forms], Windows Forms custom controls"
  - "custom controls [Windows Forms], inheritance"

#customer intent: As a developer, I want to create a simple control so that I can learn more about how they're structured and designed.

---
# Create a simple custom control

This article teaches you the key steps for authoring a custom Windows Forms control. The simple control developed in this how-to allows the alignment of its <xref:System.Windows.Forms.Control.Text> property to be changed. It doesn't raise or handle events.

## Add a custom control

The first step is to add a custom control to your project.

01. In Visual Studio, find the **Solution Explorer** window. Right-click on the project and choose **Add** > **New Item**.

    :::image type="content" source="../media/shared/visual-studio-right-click-project-add.png" alt-text="An image of Visual Studio. In the Solution Explorer window, the project was right-clicked showing a menu, in which the Add item is selected, which opens another menu option highlighting 'New Item'.":::

01. Search for **Custom Control** and select it.
01. Set the file name to **FirstControl** and **Add** to add the control.
01. In **Design** mode of the control, press <kbd>F7</kbd> or click the **switch to code view** link.

    > [!TIP]
    > You can also right-click the file in the **Solution Explorer** window and select **View Code**.

You should now be looking at the source code for the custom control, which looks similar to the following code snippet:

:::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/DefaultTemplate/FirstControl.cs" id="template":::

## Code the custom control

In this section you add the following to the custom control:

- Add a property and field to handle the horizontal alignment setting of the text.
- Use `OnTextChanged` to repaint the control.
- Update the `OnPaint` method to draw the text.

### Add the property

The `TextAlignment` property will change how the text is painted on the control. It's backed by a field named `_textAlignment`, and is a <xref:System.Windows.Forms.HorizontalAlignment> enumeration.

With the `FirstControl` class, perform the following steps:

01. Add a field named `_textAlignment` of the type `HorizontalAlignment`.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="field":::

01. Wrap the field in a property named `TextAlignment`. When setting the property, call the `Invalidate` method to force `OnPaint` to run.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="property":::

01. Add the following attributes to the property to integrate it with the **Properties** window in Visual Studio.

    - `Category` &mdash; The category applied to the property.
    - `Description` &mdash; The description of the property.
    - `DefaultValue` &mdash; A default value for the property to enable resetting the property and help serialization of the property.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="attributes":::

### Text changed

The `TextAlignment` property calls `Invalidate` so that the control repaints itself with the latest value, using the `Text` of the control. However, if the `Text` property changes, nothing is updated. The `Text` property doesn't call `Invalidate`. However, it does call the `OnTextChanged` method, which you can override to force repainting.

With the `FirstControl` class, perform the following steps:

01. Override the `OnTextChanged` method.
01. Call `base.OnTextChanged` to ensure that the `TextChanged` event is raised.
01. Call the `Invalidate` method to force repainting.

Your code should look like the following:

:::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="ontextchanged":::

### Handle panting

The last part of the custom control is painting. This control uses the `_textAlignment` field to determine how to format the text of the control, then paints the text accordingly. Painting uses the the <xref:System.Drawing.StringFormat?displayProperty=fullName> type, which encapsulates text layout information and provides access to alignment. The <xref:System.Drawing.Graphics.DrawString*?displayProperty=nameWithType> method uses text, a font, color, and formatting options to draw a string.

With the `FirstControl` class, perform the following steps:

01. Locate the `OnPaint` method that's generated by the template. If it's missing, override it from the base class.
01. Create a new `StringFormat` variable named `style`.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="style":::

01. Based on `_textAlignment`, set the `style.Alignment` property to the appropriate value.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="alignment":::

01. Draw the `Text` property with `Graphics.DrawString`.

    :::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="drawstring":::

    > [!IMPORTANT]
    > The `Graphics.DrawString` method uses a `Brush` for the color of the text. `Brushes` must be disposed of after use.

01. Call `base.OnPaint` to ensure that the `Paint` event is raised.
01. Save the code file and compile the project. After the project compiles, Visual Studio adds the custom control to the **Toolbox** window.

Your code should look like the following:

:::code language="csharp" source="./snippets/how-to-create-simple-custom-control/csharp/FirstControl.cs" id="firstcontrol":::

## Related content

-  [Custom controls](overview.md)
-  <xref:System.Drawing.Graphics.DrawString*?displayProperty=fullName>
-  <xref:System.Windows.Forms.HorizontalAlignment?displayProperty=nameWithType>
-  <xref:System.Windows.Forms.Control.OnPaint(System.Windows.Forms.PaintEventArgs)?displayProperty=fullName>
